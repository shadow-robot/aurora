"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[609],{30586:(e,t,a)=>{let n;a.d(t,{Op:()=>n,L2:()=>_,t:()=>d,fm:()=>u,o_:()=>c,wf:()=>o,Xq:()=>s,kz:()=>h,JJ:()=>g,f0:()=>v}),function(e){e.ELIGIBLE="trial_eligible",e.ACTIVE="trial_active",e.EXPIRED="trial_expired"}(n||(n={}));var r=a(13429),i=a(13798);const s=e=>(0,r.K)(e),o=e=>(0,i.h)(e),c=e=>(0,r.K)(e),u=e=>(0,i.h)(e);a(74870);var l=a(28154);function d(e,t){return!(!e||!t?.adminIds?.length)&&t.adminIds.includes(e)}const _=e=>!!(e?.isCustomer&&e?.hasPaidPlan&&!e?.hasPaymentDetails&&e.nextBillingDate&&(0,l.Cp)(e.nextBillingDate)<=0);var m=a(15451),p=a(14928);const f=e=>e?.account;function g(){return(0,p.hl)(f)}var y=a(73646);const v=()=>(0,y.xJ)((e=>e&&e.accounts?e.accounts[0]:void 0));function h(e){const{data:t}=g(),{data:a}=v(),n=e?e.account:t;return n?(0,m.b)(n,a):null}},15451:(e,t,a)=>{a.d(t,{b:()=>s}),a(74870);var n=a(30586),r=a(28154);function i(e){return e?(0,r.Cp)(e):null}function s(e,t){const a=i(e.nextBillingDate);let{trialState:s}=e;t&&(!e.trialState||e.trialState&&"trial_expired"===e.trialState)&&(s=function(e){const t=i(e.nextBillingDate)??0;let a=null;const r=e.hasPaidPlan&&null!==e.nextBillingDate&&!e.isCustomer&&"bank_transfer"!==e.paymentMethodType&&"yearly"!==e.billingCycle&&"lifetime"!==e.billingCycle;return r&&t<=0?a=n.Op.EXPIRED:r&&t>0&&(a=n.Op.ACTIVE),a}(t));const o=a&&a>0&&e.nextBillingDate?(0,r.Sy)(e.nextBillingDate):null,c=!!s&&[n.Op.ELIGIBLE,n.Op.ACTIVE].includes(s),u="trial_active"===s;return{campaign:e.registrationCampaign,daysRemaining:a,state:s,timeUntilExpiry:o,activeOrEligible:c,active:u}}},92954:(e,t,a)=>{function n(e){const t=window.localStorage.getItem(`HJ_OVERRIDE_FEATURE:${e}`);return"1"===t||"true"===t||"0"!==t&&"false"!==t&&null}a.d(t,{g:()=>n})},85049:(e,t,a)=>{a.d(t,{w:()=>i});var n=a(86599),r=a.n(n);async function i(){return(await r().get("/api/v1/settings")).data}},13205:(e,t,a)=>{function n(){return window.settings}a.d(t,{U:()=>n}),a(85049)},66900:(e,t,a)=>{a.d(t,{lu:()=>y,o0:()=>h,v9:()=>g,xL:()=>w});var n=a(88215),r=a(92065),i=a(27759),s=a(77508),o=a(26169),c=a(41218),u=a(86781),l=a(73646),d=a(12245),_=a(30586),m=a(14928),p=a(92891),f=a(78239);function g(){return void 0!==i.Z.get("REF")}const y=()=>{const e=c.mM.get("userData")||{};return e.version=e.version||0,e.userId&&o.identify(e.userId,e.currentSite?.id),e},v=e=>{c.mM.set("userData",e)},h=()=>{v({})},w=()=>u.E.fetchQuery(l.WN,l.ts,{staleTime:0,cacheTime:36e5}).then((e=>{if(!e)throw new Error("Unauthorized");const t=(e=>({...e,userCreated:e.created,userEmail:e.email,userEmailBlocked:e.emailBlocked,userId:e.id,userName:e.name,userPictureUrl:e.avatar,userRole:e.role}))(e),a=(e=>{const t={...e,accounts:e.accounts?.map((e=>(0,_.o_)(e))),accountId:e.accounts&&e.accounts[0].id,countryCode:e.country||void 0,version:window.settings.version};return v(t),t})(t);return d.EX.setAnonymizedUserId(t.currentIp),d.EX.setCountryCode(a.countryCode),d.D_.setSentryIdentity(t.userId),(e=>{if(e.userId){const t=e.currentSite?e.currentSite.id:void 0;d.EX.identify(e.userId,t)}})(t),(e=>{const{userId:t}=e;return u.E.invalidateQueries(p.jS).then((()=>u.E.fetchQuery(p.jS,(()=>(0,p.YG)(t)),{staleTime:0,cacheTime:36e5}).then((e=>(0,f.N)(e)))))})(i=t).then((e=>{const t=e;let{currentSite:a}=i;const{sites:o}=t;return a=(a?(0,n.Z)(o,{id:a.id}):void 0)||(["/onboarding","/register","/login","/login/mfa","/setup",s.SETTINGS.ACCOUNT.path,s.SITE.LIST.path,s.ONBOARDING.JOIN_TEAM.path,""].every((e=>window.location.pathname!==e))||(0,r.Z)(o)?void 0:o[0]),(0,m.eW)(a?.id),a?(0,p.Rm)((0,m.hE)(a,e.organizations)):(0,p.Rm)(void 0),t.sites.forEach((e=>{const t=e;t.name=t.name||"My site"})),t}));var i}))},30654:(e,t,a)=>{a.d(t,{s:()=>n}),a(86599),a(73646);const n="site-access"},28154:(e,t,a)=>{a.d(t,{Cp:()=>c,No:()=>r,Sn:()=>i,Sy:()=>s,mI:()=>o});var n=a(3413);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Do MMMM YYYY";return void 0===e?"":n._.unix(e).format(t)}function i(e){return void 0===e?":":(0,n._)(1e3*e).format("YYYY-MM-DD HH:mm:ss")}function s(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=1e3*e,s=(0,n._)(i),o=(0,n._)().subtract(t??604800,"s");if(!s.isBefore(o))return s.fromNow();const c=!a&&s.isBefore((0,n._)().startOf("year"));let u="";return u=r&&c?"Do MMMM YYYY":r&&!c?"Do MMMM":!r&&c?"D MMM YYYY, HH:mm":"D MMM, HH:mm",s.format(u)}function o(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=t?"MMM":"MMMM";return e<0||e>11?"":(0,n._)(e+1,"M").format(a)}function c(e,t){const a=(0,n._)(1e3*e).diff((0,n._)(),"days",!0);return t&&a<0?0:a}},86781:(e,t,a)=>{a.d(t,{E:()=>n});const n=new(a(89782).S)},13575:(e,t,a)=>{a.d(t,{VF:()=>_,N:()=>d,jX:()=>p,sf:()=>f,vP:()=>u,o:()=>l,Pl:()=>m,VP:()=>y,fB:()=>g,o8:()=>h,qi:()=>w});var n=a(86599),r=a.n(n),i=a(55514),s=a(92891),o=a(86781),c=a(73646);function u(e){return{id:e.id,name:e.name,users:e.users.map((e=>({...(0,c.vx)(e),access:e.access}))),access:e.access,accountAdminIds:e.account_admin_ids,accountBillingStrategy:e.account_billing_strategy,accountFeatures:e.account_features,accountId:e.account_id,alwaysOnRate:e.always_on_rate,created:e.created,effectivePlan:e.effective_plan,features:e.features,lockPlan:e.lock_plan,nextPriceType:e.next_price_type,percentageDiscount:e.percentage_discount,plan:e.plan,priceType:e.price_type,sampleRate:e.sample_rate,size:e.size}}function l(e){return{id:e.id,name:e.name,users:e.users.map((e=>({...(0,c._c)(e),access:e.access}))),access:e.access,account_admin_ids:e.accountAdminIds,account_billing_strategy:e.accountBillingStrategy,account_features:e.accountFeatures,account_id:e.accountId,always_on_rate:e.alwaysOnRate,created:e.created,effective_plan:e.effectivePlan,features:e.features,lock_plan:e.lockPlan,next_price_type:e.nextPriceType,percentage_discount:e.percentageDiscount,plan:e.plan,price_type:e.priceType,sample_rate:e.sampleRate,size:e.size}}const d="organizations",_={staleTime:36e5,cacheTime:36e5,refetchOnWindowFocus:!1},m=e=>t=>{const a=t.find((t=>t.id===e));if(!a)throw new Error("ERR_NOT_FOUND");return a};function p(e){return o.E.fetchQuery(s.jS,(()=>(0,s.YG)(e)),{...s.MA}).then((e=>{let{organizations:t}=e;return t}))}async function f(e,t,a){return(await r().post(`${(0,i.G)()}/api/v1/accounts/${e}/organizations/${t}`,{action:"invite",users:JSON.stringify(a)})).data}async function g(e,t,a){return(await r().put(`/api/v1/users/${t}/organizations/${e}`,{access:a})).data}async function y(e,t){return(await r().delete(`/api/v1/users/${t}/organizations/${e}`)).data}var v=a(66624);function h(e,t){return(0,v.useQuery)([d,t],(()=>p(t)),{select:m(e),enabled:void 0!==t,..._})}function w(e){return(0,v.useQuery)([d,e],(()=>p(e)),{enabled:void 0!==e,..._})}},14928:(e,t,a)=>{a.d(t,{yo:()=>w,UW:()=>h,xb:()=>I,vv:()=>C,nA:()=>P,IG:()=>M,D0:()=>R,Yt:()=>c,FQ:()=>u,z3:()=>o,$B:()=>l,hE:()=>i,rM:()=>s,eW:()=>f,c1:()=>S,rj:()=>E,L3:()=>b,MP:()=>W,PD:()=>L,$n:()=>J,hl:()=>q,W4:()=>B,h6:()=>Q,NE:()=>$,HX:()=>p,k4:()=>x}),a(74870);var n=a(30586),r=a(13575);function i(e,t){const a=e.organization?(0,r.vP)(e.organization):t?.find((t=>t.id===e.organization_id));if(!a)throw new Error(`No organization found for site: ${e.id}`);return{account:(0,n.wf)(e.account),alwaysOnRateChangeDate:e.always_on_rate_change_date,alwaysOnRateInterimState:e.always_on_rate_interim_state,alwaysOnRate:e.always_on_rate,anonymizeDigits:e.anonymize_digits,anonymizeEmails:e.anonymize_emails,continuousCaptureEnabled:e.continuous_capture_enabled,created:e.created,effectivePlanId:e.effective_plan_id,effectivePlan:e.effective_plan,effectiveAskPlan:e.effective_plan_for_feedback,features:e.features,firstData:e.first_data,id:e.id,industry:e.industry,interimAlwaysOnRate:e.interim_always_on_rate,interimPlanId:e.interim_plan_id,interimPlanState:e.interim_plan_state,interimSampleRate:e.interim_sample_rate,isInPlanChangePeriod:e.is_in_plan_change_period,isTwoSkusActionRequired:e.is_two_skus_action_required,lastData:e.last_data,legalName:e.legal_name,lockPlan:e.lock_plan,monetaryDiscount:e.monetary_discount,name:e.name,organizationId:e.organization_id,organization:a,percentageDiscount:e.percentage_discount,planChangeDate:e.plan_change_date,planId:e.plan_id,plan:e.plan,privacyPolicyUrl:e.privacy_policy_url,recordingCaptureKeystrokes:e.recording_capture_keystrokes,sessionCaptureConsoleConsent:e.session_capture_console_consent,sampleRateChangeDate:e.sample_rate_change_date,sampleRateInterimState:e.sample_rate_interim_state,sampleRate:e.sample_rate,stateChangeListenMode:e.state_change_listen_mode,suppressAll:e.suppress_all,suppressLocation:e.suppress_location,suppressText:e.suppress_text,trial:{active:e.trial.active,alwaysOnRate:e.trial.always_on_rate,daysRemaining:e.trial.days_remaining,exists:e.trial.exists,plan:e.trial.plan,sampleRate:e.trial.sample_rate},url:e.url,userAttributesEnabled:e.user_attributes_enabled,enforcedMfaAt:e.enforced_mfa_at?new Date(1e3*e.enforced_mfa_at):null}}function s(e,t){const a=e.organization?(0,r.o)(e.organization):t?.find((t=>t.id===e.organizationId));if(!a)throw new Error(`No organization found for site: ${e.id}`);return{account:(0,n.Xq)(e.account),always_on_rate_change_date:e.alwaysOnRateChangeDate,always_on_rate_interim_state:e.alwaysOnRateInterimState,always_on_rate:e.alwaysOnRate,anonymize_digits:e.anonymizeDigits,anonymize_emails:e.anonymizeEmails,continuous_capture_enabled:e.continuousCaptureEnabled,created:e.created,effective_plan_id:e.effectivePlanId,effective_plan:e.effectivePlan,effective_plan_for_feedback:e.effectiveAskPlan,features:e.features,first_data:e.firstData,id:e.id,industry:e.industry,interim_always_on_rate:e.interimAlwaysOnRate,interim_plan_id:e.interimPlanId,interim_plan_state:e.interimPlanState,interim_sample_rate:e.interimSampleRate,is_in_plan_change_period:e.isInPlanChangePeriod,is_two_skus_action_required:e.isTwoSkusActionRequired,last_data:e.lastData,legal_name:e.legalName,lock_plan:e.lockPlan,monetary_discount:e.monetaryDiscount,name:e.name,organization_id:e.organizationId,organization:a,percentage_discount:e.percentageDiscount,plan_change_date:e.planChangeDate,plan_id:e.planId,plan:e.plan,privacy_policy_url:e.privacyPolicyUrl,recording_capture_keystrokes:e.recordingCaptureKeystrokes,sample_rate_change_date:e.sampleRateChangeDate,sample_rate_interim_state:e.sampleRateInterimState,sample_rate:e.sampleRate,state_change_listen_mode:e.stateChangeListenMode,suppress_all:e.suppressAll,suppress_location:e.suppressLocation,suppress_text:e.suppressText,trial:{active:e.trial.active,always_on_rate:e.trial.alwaysOnRate,days_remaining:e.trial.daysRemaining,exists:e.trial.exists,plan:e.trial.plan,sample_rate:e.trial.sampleRate},url:e.url,user_attributes_enabled:e.userAttributesEnabled,enforced_mfa_at:e.enforcedMfaAt?e.enforcedMfaAt.getTime()/1e3:null}}function o(e,t){return!!e&&(t?e.lockPlan||t.lock:e.lockPlan)}function c(e){return!!e&&e.isInPlanChangePeriod&&null!==e.interimPlanId}function u(e){return!!e&&c(e)&&"downgrade"===e.interimPlanState}function l(e,t){return!(!t||!e)&&t.account.adminIds.includes(e)}var d=a(66069),_=a(22198);const m=e=>{const t=localStorage.getItem(e);if(t&&"undefined"!==t&&"null"!==t&&"0"!==t)return JSON.parse(t)},p=(0,d.Z)((e=>({preferredCurrentSiteId:m("preferredCurrentSiteId"),setPreferredCurrentSiteId:t=>e((()=>{var e;return"preferredCurrentSiteId",e=t,localStorage.setItem("preferredCurrentSiteId",JSON.stringify(e)),{preferredCurrentSiteId:t}}))}))),f=e=>{e&&(0,_.unstable_batchedUpdates)((()=>{p.getState().setPreferredCurrentSiteId(e)}))};var g=a(86599),y=a.n(g);const v=(e,t)=>`/api/v1/accounts/${e}/sites/${t}`,h=(e,t,a)=>y().post(`/api/v1/accounts/${e}/organizations/${t}/sites`,{action:"add_site",...a}).then((e=>({success:e.data.success,siteId:e.data.site_id}))),w=(e,t)=>y().post(`/api/v1/accounts/${e}/sites/${t}`,{action:"activate_trial"}),I=(e,t)=>y().delete(v(e,t)).then((e=>{let{data:t}=e;if(!t.success)throw t.error;return t})),S=async e=>{let{accountId:t,siteId:a,planId:n,requestedFrom:r}=e;const i={action:"request_plan_update",plan_id:n,ui_location_requested_from:r},{data:s}=await y().post(v(t,a),i);return s},E=async(e,t,a)=>{const n=`${v(e,t)}/share_tracking_code`,{data:r}=await y().post(n,{recipient_email:a.recipientEmail,locale:a.locale});return{success:!!r.success,errorMessage:r.error_message}},b=async(e,t)=>{let{name:a,url:n}=t;if(!e.account.id)return Promise.reject();const{data:r}=await y().put(v(e.account.id,e.id),{name:a,url:n});if(!r.success)throw r.error;return r},P=e=>y().post(`/api/v2/site/${e}/enforcemfa`),C=e=>y().post(`/api/v2/site/${e}/unenforcemfa`),M=async e=>{const t=(e=>`/api/v1/sites/${e}/daily-sessions`)(e);return(await y().get(t)).data},R=async e=>{const t=(e=>`/api/v1/sites/${e}/identified-users-custom-events`)(e),a=await y().get(t);return{identifiedSessions:a.data.identified_sessions??0,customEvents:a.data.custom_events??0,days:a.data.days}};var D=a(66624),O=a(92891),z=a(73646),k=a(86781),A=a(30654);const T=e=>e.sites,x=e=>{const{selector:t}=e??{},{data:a}=(0,z.xJ)(),n=a?.id;return{query:(0,D.useQuery)(O.jS,(()=>(0,O.YG)(n)),{enabled:!!n,select:"function"==typeof t?t:T,placeholderData:()=>{const e=(0,O.Om)();if(e)return[{...e}]},...O.MA}),invalidate:async()=>{await Promise.all([k.E.invalidateQueries(O.jS),k.E.invalidateQueries(A.s)])}}};var N=a(64934);const $=e=>{const[t,a]=(0,N.useState)("");return(0,N.useEffect)((()=>{e&&a(e.name||e.url||"my site")}),[e,a]),t},Y=e=>t=>{const a=t.sites.find((t=>t.id===e));if(!a)throw new Error(`No site found for id: ${e}`);return a},B=e=>{const{data:t}=(0,z.xJ)(),a=t?.id;return(0,D.useQuery)(O.jS,(()=>(0,O.YG)(a)),{enabled:!!a&&!!e,select:Y(e),...O.MA})};var U=a(81610);function F(e){const t=Number(e);return!Number.isNaN(t)&&t>0}const J=()=>{const e=p((e=>e.preferredCurrentSiteId?String(e.preferredCurrentSiteId):null)),t=(0,U.Z)();return(0,N.useMemo)((()=>{if(void 0===t.href)return null;const a=new URL(t.href);return function(e){const t=e.split("/"),a=t.indexOf("sites");if(-1===a||a===t.length-1)return null;const n=t[a+1];return F(n)?n:null}(a.pathname)??function(e){const t=e.get("site");return F(t)?t:null}(a.searchParams)??e}),[t,e])},Q=()=>{const{setPreferredCurrentSiteId:e}=p(),t=J();(0,N.useEffect)((()=>{t&&e(parseInt(t,10))}),[e,t])},G=e=>t=>t.sites.find((t=>t.id===e))||(t.sites&&t.sites.length>0?t.sites[0]:void 0),L=()=>{const e=p((e=>e.preferredCurrentSiteId)),{data:t}=(0,z.xJ)(),a=t?.id;return(0,D.useQuery)(O.jS,(()=>(0,O.YG)(a)),{enabled:!!a,select:G(e),placeholderData:O.Om,onSuccess:O.Rm,...O.MA})},j=(e,t)=>a=>{const n=G(e)(a);if(n)return t(n)},q=e=>{const t=p((e=>e.preferredCurrentSiteId)),{data:a}=(0,z.xJ)(),n=a?.id;return(0,D.useQuery)(O.jS,(()=>(0,O.YG)(n)),{enabled:!!n,select:j(t,e),placeholderData:()=>e((0,O.Om)()),...O.MA})},W=e=>x({selector:t=>t.sites.filter((t=>"number"!=typeof e||t.account.id===e)).sort(((e,t)=>{let{id:a}=e,{id:n}=t;return a-n}))})},92891:(e,t,a)=>{a.d(t,{MA:()=>_,Om:()=>d,Rm:()=>l,YG:()=>o,jS:()=>c});var n=a(86599),r=a.n(n),i=a(55514),s=a(78239);async function o(e){if(!e)throw new Error("UserId is mandatory");const t=await r().get(`${(0,i.G)()}/api/v1/users/${e}/resources`);return(0,s.b)(t.data)}const c="userResources",u="currentSite",l=e=>{e?localStorage.setItem(u,JSON.stringify(e)):localStorage.removeItem(u)},d=()=>{const e=localStorage.getItem(u)??"";return e?JSON.parse(e):void 0},_={staleTime:36e5,cacheTime:36e5,refetchOnWindowFocus:!1}},78239:(e,t,a)=>{a.d(t,{N:()=>s,b:()=>i});var n=a(14928),r=a(13575);function i(e){const t=e.organizations.map((e=>(0,r.vP)(e)));return{sites:e.sites.map((e=>(0,n.hE)(e,t))),organizations:t}}function s(e){const t=e.organizations.map((e=>(0,r.o)(e)));return{organizations:t,sites:e.sites.map((e=>(0,n.rM)(e,t)))}}},73646:(e,t,a)=>{a.d(t,{WN:()=>v,vx:()=>c,ts:()=>f,ae:()=>I,PR:()=>p,_c:()=>u,xJ:()=>h,J0:()=>w});var n=a(86599),r=a.n(n),i=a(42365),s=a(13798),o=a(30586);function c(e){return{id:e.id,name:e.name,email:e.email,avatar:e.picture_url}}function u(e){return{id:e.id,name:e.name,email:e.email||"",picture_url:e.avatar||""}}function l(e){return{success:e.success,accessKey:e.access_key,accountBillingCycle:e.account_billing_cycle,accountType:e.account_type,accounts:e.accounts?.map((e=>(0,o.fm)(e))),becameACustomer:e.became_a_customer,btCustomerId:e.bt_customer_id,country:e.country,currency:e.currency,currentIp:e.current_ip,hasPaymentDetails:e.has_payment_details,invitesRemaining:e.invites_remaining,isAccountAdmin:e.is_account_admin,isAdminOfOneOrganization:e.is_admin_of_one_organization,isFoundingMember:e.is_founding_member,utmParams:e.utm_params,receiveAnalysisEmails:e.receive_analysis_emails,receiveFeedbackEmails:e.receive_feedback_emails,recurringPaymentFailed:e.recurring_payment_failed,referralCode:e.referral_code,showIncompleteHeatmapModal:e.show_incomplete_heatmap_modal,subscribeToEmails:e.subscribe_to_emails,created:e.user_created,email:e.user_email,emailBlocked:e.user_email_blocked,id:e.user_id,name:e.user_name,avatar:e.user_picture_url,role:e.user_role,isSSOOnly:e.user_is_sso_only,isEnterpriseSSO:e.user_is_enterprise_sso,isEmailVerified:e.is_email_verified,isSuperuser:e.is_superuser,isDemoUser:e.is_demo_user}}const d="/api/v2/users",_=`${d}/me`;function m(e){return"user_id"in e}async function p(e){if(null!==e){const t=await r().get(`/api/v1/users/${e}`);return m(t.data)?l(t.data):void 0}}async function f(){const e=await r().get(_);if(m(e.data))return l(e.data);await(0,i.kS)()}const g=()=>r().get(`${d}/part-of-me`).then((e=>{return t=e.data,(0,s.h)(t);var t}));var y=a(66624);const v="currentUser",h=e=>(0,y.useQuery)(v,f,{select:e,staleTime:36e5,cacheTime:36e5,refetchOnWindowFocus:!1}),w=e=>{const{enabled:t=!0,refetchOnWindowFocus:a=!0}=e??{};return(0,y.useQuery)("PARTIAL_CURRENT_USER",g,{enabled:t,refetchOnWindowFocus:a})};async function I(){const e=await f();if(e)return e.accounts?.[0]?.id}}}]);