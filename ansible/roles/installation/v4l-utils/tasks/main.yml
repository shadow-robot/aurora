---
# v4l-utils installation (for setting the powerline frequency of USB cameras)

- name: Update package lists
  apt:
    update_cache: yes
  become: yes

- name: Install needed package
  apt:
    name: "{{ packages }}"
  vars:
    packages:
      - v4l-utils
  become: yes

- name: Add a block to .bashrc to set the powerline frequency of USB cameras
  blockinfile:
    dest: "{{ user_folder }}/.bashrc"
    block: |
      for i in {0..9}
      do
        v4l2-ctl -d /dev/video$i --set-ctrl power_line_frequency=1 2>/dev/null
      done
