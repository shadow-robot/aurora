---
- name: Getting UID
  shell: id -u
  register: id

- name: Creating the container
  docker_container:
    name: "{{ container_name }}"
    image: "{{image}}:{{tag}}"
    state: stopped
    env:
        verbose: "true"
        interface: "{{ ethercatinterface }}"
        QT_X11_NO_MITSHM: "1"
        LOCAL_USER_ID: "{{ id.stdout }}"
        DISPLAY: :0
    network_mode: "host"
    privileged: yes

    interactive: yes
    volumes: /tmp/.X11-unix:/tmp/.X11-unix[rw]
    command: terminator -x bash -c \"pkill -f shadow_launcher_app_xterm && /usr/local/bin/setup_dexterous_hand.sh && bash || bash\"
