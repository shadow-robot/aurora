---
- name: Checking if container exists
  shell: "if [[ -z $(docker ps -aq -f name=^/{{ container_name }}$) ]]; then echo false; else echo true; fi"
  register: container_exists

- name: Checking if container already running
  when: container_exists
  shell: "docker inspect -f '{{.State.Running}}' {{ container_name }}"
  register: container_running

- name: Exit if container already running
  import_tasks: exit.yml
  when: container_running

- name: Start container if container not running
  import_tasks: start_container.yml
  when: container_exists and not container_running

- name: Reinstalling docker container because it doesn't exist
  import_tasks: reinstall.yml
  when: not container_exists