---
- name: Checking if container already exists
  shell: docker ps -a -f name={{ container_name }} --format {%raw%}"table {{.Status}}"{%endraw%} | awk 'FNR == 2 {print}' | awk '{print $1}'
  register: status

- block:
    - debug:
        msg: "Container Already exists"
    - name: Container exists
      meta: end_play
  when: status.stdout == "Exited" or status.stdout == "Up"

- name: Log into DockerHub
  docker_login:
    username: user
    password: password

- name: Pulling the image
  docker_image:
    name: "shadowrobot/flexible-hand:{{tag}}"
