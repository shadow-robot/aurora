---
- name: Create temporary script file
  file:
    path: /tmp/update_hand_config.sh
    state: touch
    mode: u=rwx,g=rwx,o=rwx

- name: Add content to script file
  copy:
    dest: /tmp/update_hand_config.sh
    content: |
      #!/usr/bin/env bash
      # Used to update hand config.
      cd ~/projects/shadow_robot/base_deps/src/sr_hand_config
      git_branch=$(git rev-parse --abbrev-ref HEAD | xargs)
      if [[ `git status --porcelain` ]]; then
        file_changed=true
      else
        file_changed=false
      fi

      if [[ $file_changed == false ]]; then
        git remote set-url origin https://github.com/shadow-robot/sr_hand_config
        git fetch -f origin master
      else
        echo "You have custom changes in sr_hand_config, not pulling automatically."
      fi
      cd ~

- name: Move script folder over
  shell: "docker cp /tmp/update_hand_config.sh {{ container_name }}:/bin/update_hand_config.sh"
