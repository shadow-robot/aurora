---
- name: Create Desktop Folder
  copy:
    path: "{{ desktop_path }}/Shadow Icons"
    state: present
  become: yes
  changed_when: false

- name: Move Shadow Demos folder
  file:
    src: "{{ shadow_demos_folder }}"
    dest: "{{ desktop_path }}/Shadow Icons"
  become: yes
  changed_when: false

- name: Remove Shadow Demos Folder
  file:
    path: "{{ shadow_demos_folder }}"
    state: absent
  become: yes
  changed_when: false

- name: Move Shadow Advanced Launchers folder
  file:
    src: "{{ shadow_advanched_launchers_folder }}"
    dest: "{{ desktop_path }}/Shadow Icons"
  become: yes
  changed_when: false

- name: Ensure Shadow Advanced Launchers folder and contents are deleted
  file:
    path: "{{ shadow_advanched_launchers_folder }}"
    state: absent
  become: yes
  changed_when: false

- name: Find all .desktop files with Shadow in the comment
  find:
    paths: "{{ desktop_path }}"
    patterns: '*.desktop'
    contains: "^.*Comment=autogenerated_aurora"
  register: file_list

- name: Move all .desktop files with Shadow in the comment
  file:
    src: "{{ item.path }}"
    dest: "{{ desktop_path }}/Shadow Icons"
  become: yes
  changed_when: false
  with_items: "{{ file_list.files }}"

- name: Delete all .desktop files with Shadow in the comment
  file:
    path: "{{ item.path }}"
    state: absent
  become: yes
  changed_when: false
  with_items: "{{ file_list.files }}"
