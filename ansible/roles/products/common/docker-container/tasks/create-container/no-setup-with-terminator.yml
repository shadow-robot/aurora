---
- name: Set shared volumes
  set_fact:
    shared_volumes: "{{ common_shared_volumes + container_type_shared_volumes + local_custom_volume_names }}"

- name: Creating the container with terminator and no setup
  changed_when: false
  docker_container:
    name: "{{ container_name }}"
    image: "{{ full_image_name }}"
    state: present
    recreate: yes
    pull: yes
    env:
      verbose: "true"
      interface: "{{ ethercat_interface }}"
      interface_left: "{{ ethercat_left_hand }}"
      QT_X11_NO_MITSHM: "1"
      LOCAL_USER_ID: "{{ id.stdout }}"
      DISPLAY: "{{ lookup('env','DISPLAY') }}"
      ROS_MASTER_URI: "http://{{ ros_master }}:11311"
      arm_ips: "{{ arm_ip_right }}\n{{ arm_ip_left }}"
    network_mode: "host"
    pid_mode: "host"
    privileged: yes
    interactive: yes
    security_opts:
    - "seccomp: unconfined"
    ulimits:
    - "core: -1"
    volumes: "{{ shared_volumes }}"
    command: terminator {{ term_args }} -T '{{ container_terminal_title }}' -x bash
  become: yes
