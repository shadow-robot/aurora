---
- name: Set launch file paths for getting hand_serial
  set_fact:
    launch_file_path_right: "{{ shadow_hand_launcher_folder }}/sr_rhand.launch"
    launch_file_path_left: "{{ shadow_hand_launcher_folder }}/sr_lhand.launch"

- name: Download the right launch file from sr-config branch {{ config_branch }} from Github
  get_url:
    url: "https://raw.githubusercontent.com/shadow-robot/sr-config/{{ config_branch }}/sr_ethercat_hand_config/launch/sr_rhand.launch"
    dest: "{{ launch_file_path_right }}"
    mode: '755'

- name: Download the left launch file from sr-config branch {{ config_branch }} from Github
  get_url:
    url: "https://raw.githubusercontent.com/shadow-robot/sr-config/{{ config_branch }}/sr_ethercat_hand_config/launch/sr_lhand.launch"
    dest: "{{ launch_file_path_left }}"
    mode: '755'

- name: Get the right hand_serial xml_response from the right launch file
  xml:
    path: "{{ launch_file_path_right }}"
    xpath: "//attribute::*[contains(., 'srhand.launch')]/..//attribute::*[contains(., 'hand_serial')]/.."
    content: attribute
  register: xml_response_right

- name: Set the right hand_serial from xml_response_right
  set_fact:
    hand_serial: "{{ xml_response_right.matches[0].arg.value }}"

- name: Get the left hand_serial xml_response from the left launch file
  xml:
    path: "{{ launch_file_path_left }}"
    xpath: "//attribute::*[contains(., 'srhand.launch')]/..//attribute::*[contains(., 'hand_serial')]/.."
    content: attribute
  register: xml_response_left

- name: Set the left hand_serial from xml_response_left
  set_fact:
    hand_serial_left: "{{ xml_response_left.matches[0].arg.value }}"
