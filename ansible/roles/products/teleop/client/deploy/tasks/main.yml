---
- name: Set server hostname
  set_fact:
    server_hostname: "{{ hostvars[groups['server'][0]]['ansible_host'] }}"
  when: groups['server'] is defined

- name: Include installation/docker role
  include_role:
    name: installation/docker

- name: Include installation/nvidia-docker role
  include_role:
    name: installation/nvidia-docker
  when: nvidia_docker | int !=0

- name: Include installation/openvpn-server role
  include_role:
    name: installation/openvpn-server
  when: use_openvpn|bool

- name: Include docker/docker-image role
  include_role:
    name: docker/docker-image

- name: Include docker/aws role
  include_role:
    name: docker/aws
  when: use_aws|bool

- name: Include products/common/docker-container role
  include_role:
    name: products/common/docker-container
  vars:
    ros_master: "{{ server_hostname }}"
    setup_script: ""

- name: Include products/common/save-logs-icons role
  include_role:
    name: products/common/save-logs-icons

- name: Include products/common/cyberglove role
  include_role:
    name: products/common/cyberglove
  when: use_cyberglove|bool

- name: Include products/teleop/server/desktop-icons role
  include_role:
    name: products/teleop/client/desktop-icons
