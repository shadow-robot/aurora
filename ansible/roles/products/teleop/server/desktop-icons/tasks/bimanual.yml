---
- name: Set bimanual facts
  set_fact:
    desktop_icon_png: "demohands_bimanual.png"
    launch_script: "teleop_exec_bimanual.sh"
    demohand_branch: "bimanual_demohands_B_D"
    desktop_icon_name: "Teleop_control_machine_Launch_bimanual_demohands_B_D"
    hand_serial_no: "1130"
    hand_left_serial_no: "2346"

- name: Copy desktop icon
  copy:
    src: files/{{ desktop_icon_png }}
    dest: "{{ shadow_hand_launcher_folder }}/{{ desktop_icon_png }}"
    mode: '664'

- name: Create executable launch script for bimanual teleop
  template:
    src: templates/scripts/start-docker-container-nuc-bimanual.j2
    dest: "{{ shadow_hand_launcher_folder }}/{{ launch_script }}"
    mode: '755'
  vars:
    hand_serial: "{{ hand_serial_no }}"
    hand_serial_left: "{{ hand_left_serial_no }}"
    config_branch: "{{ demohand_branch }}"
  changed_when: false

- name: Create desktop icon for demohand
  template:
    src: ../../../common/resources/templates/desktop-icons/standard-icon.j2
    dest: "{{ user_folder }}/Desktop/{{ desktop_icon_name }}.desktop"
    mode: '755'
  vars:
    desktop_shortcut_name: "{{ desktop_icon_name }}"
    comment: "{{ desktop_icon_name }}"
    folder: "{{ shadow_hand_launcher_folder }}"
    shell_script_file_name: "{{ launch_script }}"
    icon_file_name: "{{ desktop_icon_png }}"

- name: Make desktop icon for demohand trusted
  shell: gio set "{{ user_folder }}/Desktop/{{ desktop_icon_name }}.desktop" "metadata::trusted" yes
  when:
    - ansible_distribution|string == 'Ubuntu'
    - ansible_distribution_release|string == 'bionic'
